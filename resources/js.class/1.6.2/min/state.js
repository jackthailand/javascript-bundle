JS.State=JS.Module({_getState:function(a){return(typeof a=='object'&&a)||(typeof a=='string'&&((this.states||{})[a]||{}))||{}},setState:function(a){this._state=this._getState(a);JS.util.State.addMethods(this._state,this.klass)},inState:function(){for(var a=0,b=arguments.length;a<b;a++){if(this._state==this._getState(arguments[a]))return true}return false}});JS.util.State={stub:function(){return this},buildStubs:function(a,b,c){var d,e;for(d in c){b[d]={};for(e in c[d])a[e]=this.stub}},buildCollection:function(a,b,c,d){var e={},f={},i=c.states||{};this.buildStubs(e,f,d);this.buildStubs(e,f,i);var g,h;for(g in f){h=(i[g]||{}).klass;h=h?JS.Class(h,d[g]):JS.Class(d[g]);h.include(e,false);f[g]=new h;JS.util.State.addMethods(f[g],b.klass)}return a.call(JS.Class,b,c,'states',f)},addMethods:function(a,b){for(var c in a)this.addMethod(b,c)},addMethod:function(b,c){b.instanceMethod(c,function(){var a=(this._state||{})[c];return a?a.apply(this,arguments):this},false)}};JS.Class.addMethod=(function(e){return function(a,b,c,d){if(c!='states'||typeof d!='object')return e.apply(JS.Class,arguments);return JS.util.State.buildCollection(e,a,b,d)}})(JS.Class.addMethod);